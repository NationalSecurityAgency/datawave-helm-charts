####################################
# Core Helm Template Configuration #
####################################

apiVersion: v1
kind: ConfigMap

######################################
# Basic Metadata for this Deployment #
######################################

metadata:
  name: "{{ .Chart.Name }}-{{ .Values.web.rabbitmqMap.meta.name }}"
  labels:
    application: "{{ .Chart.Name }}-{{ .Values.web.rabbitmqMap.meta.name }}"

##########################
# Configuration Map Data #
##########################

data: 

  #########################################
  # RabbitMQ Enabled Plugin Configuration #
  #########################################

  enabled_plugins: |
    [rabbitmq_management].
  
  ##################################
  # RabbitMQ General Configuration #
  ##################################

  rabbitmq.conf: |
    cluster_partition_handling = autoheal
    # Enable the guest user
    loopback_users.guest = false
